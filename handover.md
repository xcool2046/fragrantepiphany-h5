## ğŸ“Š å½“å‰è¿›åº¦å¿«ç…§ (Progress Snapshot)
- **å½“å‰é˜¶æ®µ**: ç”Ÿäº§ç¯å¢ƒæ”¯ä»˜åŠŸèƒ½ä¿®å¤éªŒè¯é€šè¿‡ï¼›ä¸»çº¿ä»»åŠ¡æš‚åœåœ¨â€œè¡¥å…¨ç¼ºå¤±é¦™æ°´æ•°æ®â€çš„ä¸­é—´æ­¥éª¤ã€‚
- **å·²éªŒè¯åŠŸèƒ½**:
  1. **Stripe æ”¯ä»˜ (ç”Ÿäº§ç¯å¢ƒ)**: é…ç½®å·²åˆ‡æ¢ä¸º **Hosted Configuration** (è‡ªåŠ¨æ‰˜ç®¡)ï¼Œåç«¯ç§»é™¤æ‰€æœ‰æ‰‹åŠ¨æ”¯ä»˜æ–¹å¼æŒ‡å®šï¼Œå®Œå…¨ä¾èµ– Stripe Dashboard é…ç½®ã€‚å·²éªŒè¯è§£å†³äº† 400 é”™è¯¯å’Œæƒé™ä¸è¶³é—®é¢˜ã€‚
  2. **åç«¯æœåŠ¡**: æˆåŠŸé‡å¯ï¼Œç«¯å£ 3000 ç›‘å¬æ­£å¸¸ï¼Œæ—¥å¿—æ— å¼‚å¸¸ã€‚
  3. **æŠ½ç‰Œæµç¨‹**: å‰ç«¯åŠ¨ç”»ä¸åç«¯æ¥å£ (`/api/interp/draw`) è”è°ƒæ­£å¸¸ã€‚

## ğŸ’¡ å…³é”®æŠ€æœ¯æ–¹æ¡ˆä¸æŠ€å·§ (Key Solutions & Techniques)
- **Stripe æ”¯ä»˜é›†æˆ (Critical)**:
  - **é—®é¢˜**: æ‰‹åŠ¨æŒ‡å®š `payment_method_types: ['card', 'alipay']` ä¼šå› è´¦å·æƒé™ä¸è¶³å¯¼è‡´æ•´ä¸ªæ¥å£æŠ¥é”™ 400ã€‚
  - **æœ€ç»ˆæ–¹æ¡ˆ**: **ç§»é™¤ `payment_method_types` å‚æ•°**ã€‚åˆ©ç”¨ Stripe API é»˜è®¤è¡Œä¸ºï¼ˆä½¿ç”¨ Dashboard è®¾ç½®çš„ Automatic Payment Methodsï¼‰ã€‚
  - **æ³¨æ„**: ä¸è¦åœ¨ `checkout.sessions.create` ä¸­ä¼ é€’ `automatic_payment_methods` å‚æ•°ï¼ˆè¿™æ˜¯ PaymentIntent çš„å‚æ•°ï¼‰ï¼Œå¦åˆ™ä¼šæŠ¥é”™ `parameter_unknown`ã€‚

- **åç«¯ç¨³å¥é‡å¯**:
  - **æŠ€å·§**: ä½¿ç”¨ `fuser -k 3000/tcp && ./backend/restart.sh`ã€‚
  - **åŸå› **: å•çº¯ kill è¿›ç¨‹æœ‰æ—¶é‡Šæ”¾ç«¯å£æ…¢ï¼Œå¯¼è‡´é‡å¯æ—¶æŠ¥ `EADDRINUSE`ã€‚

- **æ•°æ®æºæå–**:
  - **æ–¹æ¡ˆ**: ä¼˜å…ˆä½¿ç”¨ `xlsx` åº“ç›´æ¥è¯»å– `backend/assets/perfume.xlsx` æºæ–‡ä»¶ï¼Œè€Œéä¾èµ–åˆ†æä¸­é—´ JSON æ–‡ä»¶ã€‚

## ğŸš§ é—ç•™éš¾ç‚¹ä¸å¾…åŠ (Pending Issues)
- **ç¼ºå¤±çš„ 6 æ¬¾é¦™æ°´æ•°æ® (Missing Perfume Data)**
  - **çŠ¶æ€**: è„šæœ¬å·²å°±ç»ªï¼Œå¾…æ‰§è¡ŒéªŒè¯ã€‚
  - **ä»»åŠ¡**: éœ€è¦æ‰¾åˆ° ID ä¸º 153, 157, 161, 165, 169, 173 çš„é¦™æ°´æ•°æ® (Red Roses, Wonderwood ç­‰)ã€‚
  - **å·²å°è¯•**: `check_missing_data.ts` ç¡®è®¤äº†ç¼ºå¤±åå•ã€‚
  - **æ¥åŠ›ç‚¹**: è¿è¡Œ `backend/extract_missing_perfumes_v2.ts`ã€‚

## ğŸ“‚ æ ¸å¿ƒæ–‡ä»¶ç»“æ„ (Core Directory Structure)
```text
/home/projects/h5/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pay/
â”‚   â”‚   â”‚   â””â”€â”€ pay.service.ts       # æ”¯ä»˜æ ¸å¿ƒæœåŠ¡ (å·²é‡æ„ä¸ºæ‰˜ç®¡æ¨¡å¼)
â”‚   â”‚   â”œâ”€â”€ perfume/                 # é¦™æ°´æ¨¡å—
â”‚   â”‚   â””â”€â”€ entities/                # TypeORM å®ä½“
â”‚   â”œâ”€â”€ assets/
â”‚   â”‚   â”œâ”€â”€ perfume.xlsx             # é¦™æ°´æ•°æ®æºæ–‡ä»¶
â”‚   â”‚   â””â”€â”€ excel_files/             # å…¶ä»– Excel å¤‡ä»½
â”‚   â”œâ”€â”€ extract_missing_perfumes_v2.ts # [å·¥å…·] å¾…è¿è¡Œï¼šæå–ç¼ºå¤±æ•°æ®
â”‚   â”œâ”€â”€ check_prod_keys.ts           # [å·¥å…·] ç”Ÿäº§ç¯å¢ƒé…ç½®æ£€æŸ¥
â”‚   â”œâ”€â”€ restart.sh                   # æœåŠ¡é‡å¯è„šæœ¬
â”‚   â””â”€â”€ backend.log                  # è¿è¡Œæ—¥å¿—
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ src/pages/PerfumeView.tsx    # å‰ç«¯å±•ç¤ºé¡µ
```

## â¡ï¸ ä¸‹ä¸€æ­¥æŒ‡ä»¤ (Next Action)
1. **æ‰§è¡Œæ•°æ®æå–**: è¿è¡Œ `npx ts-node backend/extract_missing_perfumes_v2.ts`ï¼Œç¡®è®¤æ˜¯å¦èƒ½ä» Excel ä¸­æå–åˆ° 6 æ¬¾ç¼ºå¤±é¦™æ°´çš„å®Œæ•´ä¿¡æ¯ï¼ˆå« Brand, Name, Description, Tagsï¼‰ã€‚
2. **ç¼–å†™å…¥åº“è„šæœ¬**: æ ¹æ®æå–åˆ°çš„ JSON ç»“æœï¼Œç¼–å†™ä¸€ä¸ªæ–°çš„è¿ç§»è„šæœ¬æˆ– seed è„šæœ¬ï¼Œå°†è¿™ 6 æ¡æ•°æ®æ’å…¥åˆ°ç‰¹å®š ID (153, 157...)ã€‚
3. **éªŒè¯æ”¯ä»˜ä½“éªŒ**: æ—¢ç„¶æ”¯ä»˜ä»£ç å·²æ”¹ï¼Œå»ºè®®åœ¨å¤„ç†å®Œæ•°æ®åï¼Œé¡ºæ‰‹ç‚¹ä¸€ä¸‹å‰ç«¯æ”¯ä»˜æŒ‰é’®ï¼Œç¡®ä¿ Stripe æ‰˜ç®¡é¡µé¢èƒ½æ­£å¸¸å¼¹å‡ºï¼ˆæ˜¾ç¤º Card/Apple Payï¼‰ã€‚
4. **ä¸¥ç¦æ“ä½œ**: **ç»å¯¹ä¸è¦** ä¿®æ”¹ `pay.service.ts` å›é€€åˆ°æ‰‹åŠ¨æŒ‡å®šæ”¯ä»˜æ–¹å¼çš„æ•°ç»„å†™æ³•ã€‚
